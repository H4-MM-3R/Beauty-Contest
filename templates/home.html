<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Home - Hub App</title>
</head>
<body>
    <h1>Welcome to the Keynesian Beauty Contest Game</h1>
    <button id="createHubBtn">Create New Hub</button>
    <br><br>
    <form id="joinHubForm">
        <label for="hubInput">Enter Hub Hash to Join:</label>
        <input type="text" id="hubInput" name="hub" required>
        <br>
        <label for="username">Your Name:</label>
        <input type="text" id="username" name="name" required>
        <button type="submit">Join Hub</button>
    </form>

    <script>
        document.getElementById("createHubBtn").addEventListener("click", function() {
            fetch("/create-hub", {
                method: "POST"
            })
            .then(response => response.json())
            .then(data => {
                if(data.hub) {
                    let name = prompt("Enter your name:");
                    if(!name) {
                        alert("Name is required");
                        return;
                    }
                    // Redirect to the game page with hub hash and name.
                    window.location.href = "/" + data.hub + "?name=" + encodeURIComponent(name);
                }
            })
            .catch(err => {
                alert("Error creating hub: " + err);
            });
        });

        document.getElementById("joinHubForm").addEventListener("submit", function(e) {
            e.preventDefault();
            let hubHash = document.getElementById("hubInput").value.trim();
            let name = document.getElementById("username").value.trim();
            if(hubHash && name) {
                window.location.href = "/" + hubHash + "?name=" + encodeURIComponent(name);
            }
        });
    </script>
</body>
</html>

